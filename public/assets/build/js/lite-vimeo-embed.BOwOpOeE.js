function a(o,t,n){const e=document.createElement("link");e.rel=o,e.href=t,e.crossorigin=!0,document.head.appendChild(e)}function r(){var o=document.createElement("canvas");return o.getContext&&o.getContext("2d")?o.toDataURL("image/webp").indexOf("data:image/webp")===0:!1}function d({width:o,height:t}){let n=o,e=t;return n%320!==0&&(n=Math.ceil(o/100)*100,e=Math.round(n/o*t)),{width:n,height:e}}class i extends HTMLElement{constructor(){super()}async connectedCallback(){this.videoId=encodeURIComponent(this.getAttribute("videoid"));const t=await this._getThumbnailURL();this.style.backgroundImage=`url("${t}")`;const n=document.createElement("button");n.type="button",n.classList.add("ltv-playbtn"),this.appendChild(n),this.addEventListener("pointerover",i._warmConnections,{once:!0}),this.addEventListener("click",()=>this._addIframe())}async _getThumbnailURL(){d(this.getBoundingClientRect());const t=`https://vimeo.com/api/v2/video/${this.videoId}.json`,e=(await(await fetch(t)).json())[0].thumbnail_large,s=e.substr(e.lastIndexOf("/")+1).split("_")[0];console.log(e);let c=`https://i.vimeocdn.com/video/${s}`;return c+=`.${r()?"webp":"jpg"}`,console.log(c),c}static _warmConnections(){i.preconnected||(a("preconnect","https://player.vimeo.com"),a("preconnect","https://i.vimeocdn.com"),a("preconnect","https://f.vimeocdn.com"),a("preconnect","https://fresnel.vimeocdn.com"),i.preconnected=!0)}_addIframe(){const t=`
<iframe width="640" height="360" frameborder="0"
  allow="accelerometer; autoplay; encrypted-media; gyroscope; picture-in-picture" allowfullscreen
  src="https://player.vimeo.com/video/${this.videoId}?autoplay=1"
></iframe>`;this.insertAdjacentHTML("beforeend",t),this.classList.add("ltv-activated")}}customElements.define("lite-vimeo",i);
