function c(i,n,e){const t=document.createElement("link");t.rel=i,t.href=n,e&&(t.as=e),t.crossorigin=!0,document.head.appendChild(t)}function r(){var i=document.createElement("canvas");return i.getContext&&i.getContext("2d")?i.toDataURL("image/webp").indexOf("data:image/webp")===0:!1}function d({width:i,height:n}){let e=i,t=n;return e%320!==0&&(e=Math.ceil(i/100)*100,t=Math.round(e/i*n)),{width:e,height:t}}class o extends HTMLElement{constructor(){super()}async connectedCallback(){this.videoId=encodeURIComponent(this.getAttribute("videoid"));const n=await this._getThumbnailURL();this.style.backgroundImage=`url("${n}")`;const e=document.createElement("button");e.type="button",e.classList.add("ltv-playbtn"),this.appendChild(e),this.addEventListener("pointerover",o._warmConnections,{once:!0}),this.addEventListener("click",()=>this._addIframe())}async _getThumbnailURL(){d(this.getBoundingClientRect());const n=`https://vimeo.com/api/v2/video/${this.videoId}.json`,t=(await(await fetch(n)).json())[0].thumbnail_large,s=t.substr(t.lastIndexOf("/")+1).split("_")[0];console.log(t);let a=`https://i.vimeocdn.com/video/${s}`;return a+=`.${r()?"webp":"jpg"}`,console.log(a),a}static _warmConnections(){o.preconnected||(c("preconnect","https://player.vimeo.com"),c("preconnect","https://i.vimeocdn.com"),c("preconnect","https://f.vimeocdn.com"),c("preconnect","https://fresnel.vimeocdn.com"),o.preconnected=!0)}_addIframe(){const n=`
<iframe width="640" height="360" frameborder="0"
  allow="accelerometer; autoplay; encrypted-media; gyroscope; picture-in-picture" allowfullscreen
  src="https://player.vimeo.com/video/${this.videoId}?autoplay=1"
></iframe>`;this.insertAdjacentHTML("beforeend",n),this.classList.add("ltv-activated")}}customElements.define("lite-vimeo",o);
